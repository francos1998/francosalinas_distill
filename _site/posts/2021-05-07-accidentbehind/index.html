<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
<title>Analytics and ML Projects: Behind Scenes: Prediction of the severity of car accidents</title>

<meta property="description" itemprop="description" content="In depth analysis of modelling decisions, coding and recommendations when approaching car accidents prediction."/>


<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2021-05-07"/>
<meta property="article:created" itemprop="dateCreated" content="2021-05-07"/>
<meta name="article:author" content="Juthi Dewan, Coco Li, Franco Salinas"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Analytics and ML Projects: Behind Scenes: Prediction of the severity of car accidents"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="In depth analysis of modelling decisions, coding and recommendations when approaching car accidents prediction."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Analytics and ML Projects"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="Analytics and ML Projects: Behind Scenes: Prediction of the severity of car accidents"/>
<meta property="twitter:description" content="In depth analysis of modelling decisions, coding and recommendations when approaching car accidents prediction."/>

<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","preview","output"]}},"value":[{"type":"character","attributes":{},"value":["Behind Scenes: Prediction of the severity of car accidents"]},{"type":"character","attributes":{},"value":["In depth analysis of modelling decisions, coding and recommendations when approaching car accidents prediction."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Juthi Dewan, Coco Li, Franco Salinas"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":[]}},"value":[]}]}]},{"type":"character","attributes":{},"value":["05-07-2021"]},{"type":"character","attributes":{},"value":["behind.jpg"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["accidentbehind_files/anchor-4.2.2/anchor.min.js","accidentbehind_files/bowser-1.9.3/bowser.min.js","accidentbehind_files/distill-2.2.21/template.v2.js","accidentbehind_files/figure-html5/unnamed-chunk-3-1.png","accidentbehind_files/figure-html5/unnamed-chunk-3-2.png","accidentbehind_files/figure-html5/unnamed-chunk-3-3.png","accidentbehind_files/jquery-1.11.3/jquery.min.js","accidentbehind_files/popper-2.6.0/popper.min.js","accidentbehind_files/tippy-6.2.7/tippy-bundle.umd.min.js","accidentbehind_files/tippy-6.2.7/tippy-light-border.css","accidentbehind_files/tippy-6.2.7/tippy.css","accidentbehind_files/tippy-6.2.7/tippy.umd.min.js","accidentbehind_files/webcomponents-2.0.0/webcomponents.js","behind.jpg","small_accidents.csv","traffic_final.csv"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<style type="text/css">
/* --------------------------------------------------------
   GLOBAL LAYOUT IMPROVEMENTS
---------------------------------------------------------*/

/* Increase max-width of content */
.distill-site-container {
  max-width: 1200px !important;
}

/* More compact body text for professional look */
body, p {
  font-size: 17px;
  line-height: 1.55;
  color: #333;
}

/* --------------------------------------------------------
   RIGHT-HAND TABLE OF CONTENTS
---------------------------------------------------------*/

.d-toc {
  position: fixed !important;
  right: 20px;
  top: 120px;
  width: 220px;
  max-height: 80vh;
  overflow-y: auto;
  border-left: 2px solid #eee;
  padding-left: 15px;
}

.d-article {
  margin-right: 260px !important; /* Leaves room for TOC */
}

/* Highlight TOC item on hover */
.d-toc a:hover {
  font-weight: 600;
  color: #0077cc;
}

/* --------------------------------------------------------
   LEFT SIDEBAR (GITHUB / LINKEDIN / EMAIL)
---------------------------------------------------------*/

.distill-site-sidebar {
  position: fixed;
  top: 140px;
  left: 20px;
  width: 150px;
  padding: 10px;
  border-right: 1px solid #eee;
}

.distill-site-sidebar a {
  display: block;
  margin-bottom: 12px;
  font-weight: 500;
  color: #444 !important;
}

.distill-site-sidebar a:hover {
  color: #0077cc !important;
}

/* Push content away from left sidebar */
.d-article-container {
  margin-left: 170px !important;
}

/* --------------------------------------------------------
   NAVBAR STYLING
---------------------------------------------------------*/

.navbar {
  background-color: #ffffff;
  border-bottom: 1px solid #e6e6e6;
}

.navbar-nav .nav-link {
  font-size: 16px;
  padding-right: 18px !important;
}

.navbar-brand {
  font-size: 20px;
  font-weight: 600;
}

/* --------------------------------------------------------
   IMAGES & FIGURES
---------------------------------------------------------*/

img {
  border-radius: 6px;
  margin: 12px 0;
}

/* --------------------------------------------------------
   CLEAN HEADINGS
---------------------------------------------------------*/

h1, h2, h3, h4 {
  font-weight: 600;
  color: #222;
}

/* Slight spacing between sections */
section {
  margin-bottom: 45px;
}

</style>
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Behind Scenes: Prediction of the severity of car accidents","description":"In depth analysis of modelling decisions, coding and recommendations when approaching car accidents prediction.","authors":[{"author":"Juthi Dewan, Coco Li, Franco Salinas","authorURL":{},"affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-05-07T00:00:00.000-05:00","citationText":"Salinas, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">Franco Salinas</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../blog.html">Projects</a>
<a href="https://github.com/francos1998">
<i class="fa fa-github" aria-hidden="true"></i>
</a>
<a href="https://www.linkedin.com/in/francosalinas01/">
<i class="fa fa-linkedin" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Behind Scenes: Prediction of the severity of car accidents</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>In depth analysis of modelling decisions, coding and recommendations when approaching car accidents prediction.</p></p>
</div>

<div class="d-byline">
  Juthi Dewan, Coco Li, Franco Salinas true 
  
<br/>05-07-2021
</div>

<div class="d-article">
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-datatable.com'>data.table</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-spatial.github.io/sf/'>sf</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>         <span class='co'># for reading in data, graphing, and cleaning</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidymodels.tidymodels.org'>tidymodels</a></span><span class='op'>)</span>        <span class='co'># for modeling ... tidily</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://glmnet.stanford.edu'>glmnet</a></span><span class='op'>)</span>            <span class='co'># for regularized regression, including LASSO</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/njtierney/naniar'>naniar</a></span><span class='op'>)</span>            <span class='co'># for examining missing values (NAs)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://lubridate.tidyverse.org'>lubridate</a></span><span class='op'>)</span>         <span class='co'># for date manipulation</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/moderndive/moderndive/issues'>moderndive</a></span><span class='op'>)</span>        <span class='co'># for King County housing data</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/koalaverse/vip/'>vip</a></span><span class='op'>)</span>               <span class='co'># for variable importance plots</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/rstudio/rmarkdown'>rmarkdown</a></span><span class='op'>)</span>         <span class='co'># for paged tables</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/tidymodels/themis'>themis</a></span><span class='op'>)</span>            <span class='co'># for step functions for unbalanced data</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>stacks</span><span class='op'>)</span>            <span class='co'># for stacking models</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dalex.drwhy.ai'>DALEX</a></span><span class='op'>)</span>             <span class='co'># for model interpretation  </span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ModelOriented.github.io/DALEXtra/'>DALEXtra</a></span><span class='op'>)</span>          <span class='co'># for extension of DALEX</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span>         <span class='co'># for combining plots nicely</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://scales.r-lib.org'>scales</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://plotly-r.com'>plotly</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>gridExtra</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/juliasilge/tidytext'>tidytext</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://modelr.tidyverse.org'>modelr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/topepo/caret/'>caret</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>ROSE</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://glmnet.stanford.edu'>glmnet</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/bethatkinson/rpart'>rpart</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.milbo.org/rpart-plot/index.html'>rpart.plot</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://www.stat.berkeley.edu/~breiman/RandomForests/'>randomForest</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://shiny.rstudio.com'>shiny</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rstudio.github.io/bslib/'>bslib</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>warn <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'>theme_set</span><span class='op'>(</span><span class='fu'>theme_minimal</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># my favorite ggplot2 theme :)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cars</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"small_accidents.csv"</span>, col_types <span class='op'>=</span> <span class='fu'>cols</span><span class='op'>(</span>.default <span class='op'>=</span> <span class='fu'>col_character</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>type_convert</span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>cars</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>City</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarize</a></span><span class='op'>(</span>Count<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>Count</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fl'>1000</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1,000 x 2
   City        Count
   &lt;chr&gt;       &lt;int&gt;
 1 Houston      9612
 2 Los Angeles  7771
 3 Charlotte    7435
 4 Dallas       6545
 5 Austin       5832
 6 Miami        5207
 7 Raleigh      4420
 8 Atlanta      3760
 9 Orlando      3300
10 Sacramento   3150
#  with 990 more rows</code></pre>
</div>
<h2 id="introduction">Introduction</h2>
<p>The Fatality Analysis Reporting System indicated that an estimate of 8870 people died in motor vehicle traffic crashes in the second quarter of 2020 (NHTSA, 2020). This analysis is intended to bring light to the main environmental conditions that are associated with the severity of a car accident. For the purpose of this study we defined severity as the accidents impact on traffic.</p>
<h2 id="data">Data</h2>
<p>The data we used has 47 variables and 3 million observations for different car accidents. The data was collected from February 2016 to December 2020 for the 49 states of the US. The data base has been constructed partly by Moosavi, Sobhan, Mohammad Hossein Samavatian, Srinivasan Parthasarathy, and Rajiv Ramnath as A Countrywide Traffic Accident Dataset (2019). The other part of the data base was constructed by Moosavi, Sobhan, Mohammad Hossein Samavatian, Srinivasan Parthasarathy, Radu Teodorescu, and Rajiv Ramnath for their database Accident Risk Prediction based on Heterogeneous Sparse Data: New Dataset and Insights.</p>
<h2 id="models">Models</h2>
<p>Using this data set, we predicted the Severity of an accident using stacked LASSO, Forest and classification three. Stacking combines predictions from many different models into a super predictor. In this case we would be averaging the predictions of the LASSO, Forest and classification three.</p>
<h2 id="pre-processing">Pre-processing</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cars</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise_all.html'>summarise_all</a></span><span class='op'>(</span><span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>pivot_longer</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>49</span>, names_to <span class='op'>=</span> <span class='st'>"Variables to drop"</span>, values_to <span class='op'>=</span> <span class='st'>"NA proportion"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>`NA proportion`</span> <span class='op'>&gt;=</span> <span class='fl'>0.5</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 3 x 2
  `Variables to drop` `NA proportion`
  &lt;chr&gt;                         &lt;dbl&gt;
1 End_Lat                       0.636
2 End_Lng                       0.636
3 Number                        0.633</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>drop_na_cols</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"End_Lat"</span>, <span class='st'>"End_Lng"</span>, <span class='st'>"Number"</span><span class='op'>)</span>

<span class='va'>not_useful</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ID"</span>, <span class='st'>"Source"</span>, <span class='st'>"Timezone"</span>, <span class='st'>"Airport_Code"</span>, <span class='st'>"Weather_Timestamp"</span>,<span class='st'>"Wind_Direction"</span>, <span class='st'>"Description"</span>, <span class='st'>"Bump"</span>, <span class='st'>"Traffic_Calming"</span>, <span class='st'>"Give_Way"</span>, <span class='st'>"No_Exit"</span>, <span class='st'>"Railway"</span>, <span class='st'>"Roundabout"</span>, <span class='st'>"Station"</span>, <span class='st'>"Stop"</span>, <span class='st'>"Amenity"</span>, <span class='st'>"Street"</span>, <span class='st'>"Zipcode"</span>, <span class='st'>"Country"</span>, <span class='st'>"Turning_Loop"</span>, <span class='st'>"County"</span>, <span class='st'>"TMC"</span><span class='op'>)</span>


<span class='va'>traffic</span> <span class='op'>&lt;-</span>
  <span class='va'>cars</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/all_of.html'>all_of</a></span><span class='op'>(</span><span class='va'>drop_na_cols</span><span class='op'>)</span>, <span class='op'>-</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/all_of.html'>all_of</a></span><span class='op'>(</span><span class='va'>not_useful</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>cars</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>Station</span><span class='op'>)</span>, <span class='va'>..prop..</span>, group <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_bar</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span>, position <span class='op'>=</span> <span class='st'>"dodge"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='va'>percent</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>60</span>, vjust <span class='op'>=</span> <span class='fl'>0.6</span><span class='op'>)</span><span class='op'>)</span>
 
<span class='va'>p2</span> <span class='op'>&lt;-</span>  <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>cars</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>Turning_Loop</span>, <span class='va'>..prop..</span>, group <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_bar</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span>, position <span class='op'>=</span> <span class='st'>"dodge"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='va'>percent</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>60</span>, vjust <span class='op'>=</span> <span class='fl'>0.6</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>p3</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>cars</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>Country</span>, <span class='va'>..prop..</span>, group <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_bar</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span>, position <span class='op'>=</span> <span class='st'>"dodge"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='va'>percent</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>60</span>, vjust <span class='op'>=</span> <span class='fl'>0.6</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>p4</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>cars</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>Amenity</span>, <span class='va'>..prop..</span>, group <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_bar</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span>, position <span class='op'>=</span> <span class='st'>"dodge"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='va'>percent</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>60</span>, vjust <span class='op'>=</span> <span class='fl'>0.6</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>p5</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>cars</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>Stop</span>, <span class='va'>..prop..</span>, group <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_bar</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span>, position <span class='op'>=</span> <span class='st'>"dodge"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='va'>percent</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>60</span>, vjust <span class='op'>=</span> <span class='fl'>0.6</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>p6</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>cars</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>Station</span>, <span class='va'>..prop..</span>, group <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_bar</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span>, position <span class='op'>=</span> <span class='st'>"dodge"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='va'>percent</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>60</span>, vjust <span class='op'>=</span> <span class='fl'>0.6</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>p7</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>cars</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>Roundabout</span>, <span class='va'>..prop..</span>, group <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_bar</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span>, position <span class='op'>=</span> <span class='st'>"dodge"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='va'>percent</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>60</span>, vjust <span class='op'>=</span> <span class='fl'>0.6</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>p8</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>cars</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>Railway</span>, <span class='va'>..prop..</span>, group <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_bar</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span>, position <span class='op'>=</span> <span class='st'>"dodge"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='va'>percent</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>60</span>, vjust <span class='op'>=</span> <span class='fl'>0.6</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>p9</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>cars</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>No_Exit</span>, <span class='va'>..prop..</span>, group <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_bar</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span>, position <span class='op'>=</span> <span class='st'>"dodge"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='va'>percent</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>60</span>, vjust <span class='op'>=</span> <span class='fl'>0.6</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>p10</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>cars</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>Give_Way</span>, <span class='va'>..prop..</span>, group <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_bar</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span>, position <span class='op'>=</span> <span class='st'>"dodge"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='va'>percent</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>60</span>, vjust <span class='op'>=</span> <span class='fl'>0.6</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>p11</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>cars</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>Traffic_Calming</span>, <span class='va'>..prop..</span>, group <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_bar</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span>, position <span class='op'>=</span> <span class='st'>"dodge"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='va'>percent</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>60</span>, vjust <span class='op'>=</span> <span class='fl'>0.6</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>p12</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>cars</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>Bump</span>, <span class='va'>..prop..</span>, group <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_bar</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>Severity</span><span class='op'>)</span>, position <span class='op'>=</span> <span class='st'>"dodge"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='va'>percent</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>60</span>, vjust <span class='op'>=</span> <span class='fl'>0.6</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>p1</span><span class='op'>+</span> <span class='va'>p2</span><span class='op'>+</span> <span class='va'>p3</span><span class='op'>+</span> <span class='va'>p4</span>
</code></pre>
</div>
<img src="accidentbehind_files/figure-html5/unnamed-chunk-3-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p5</span><span class='op'>+</span> <span class='va'>p6</span><span class='op'>+</span> <span class='va'>p7</span><span class='op'>+</span> <span class='va'>p8</span>
</code></pre>
</div>
<img src="accidentbehind_files/figure-html5/unnamed-chunk-3-2.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p9</span><span class='op'>+</span> <span class='va'>p10</span><span class='op'>+</span> <span class='va'>p11</span><span class='op'>+</span> <span class='va'>p12</span>
</code></pre>
</div>
<p><img src="accidentbehind_files/figure-html5/unnamed-chunk-3-3.png" width="624" /></p>
</div>
<p>We chose to not use multiple of the 47 variables that we considered werent relevant to the analysis we were conducting. As we can see in the table, end latitude, end longitudes proportion of NA values are higher than 50%. Given the distribution of wind direction through the different severity levels, we decided that the variable is uninformative. The description, bump, traffic calming, give way, no exit, railway, roundabout, station, stop, amenity, street, zip code, country, turning loop, county and TMC code werent informative either given the distribution between the severity categories or near-zero variance.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>traffic</span> <span class='op'>&lt;-</span>  <span class='va'>traffic</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"Distance"</span> <span class='op'>=</span> <span class='va'>`Distance(mi)`</span>, <span class='st'>"Temperature"</span> <span class='op'>=</span> <span class='va'>`Temperature(F)`</span>, <span class='st'>"Humidity"</span> <span class='op'>=</span> <span class='va'>`Humidity(%)`</span>,
         <span class='st'>"Pressure"</span> <span class='op'>=</span> <span class='va'>`Pressure(in)`</span>, <span class='st'>"Visibility"</span> <span class='op'>=</span> <span class='va'>`Visibility(mi)`</span>, <span class='st'>"Wind_Speed"</span> <span class='op'>=</span> <span class='va'>`Wind_Speed(mph)`</span>, <span class='st'>"Precipitation"</span> <span class='op'>=</span> <span class='va'>`Precipitation(in)`</span>, <span class='st'>"Wind_Chill"</span> <span class='op'>=</span> <span class='va'>`Wind_Chill(F)`</span><span class='op'>)</span>

<span class='va'>traffic</span><span class='op'>$</span><span class='va'>Severity</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>traffic</span><span class='op'>$</span><span class='va'>Severity</span><span class='op'>)</span>

<span class='va'>traffic</span> <span class='op'>&lt;-</span>
  <span class='va'>traffic</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/naniar/man/add_n_miss.html'>add_n_miss</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>n_miss_all</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>n_miss_all</span><span class='op'>)</span>

<span class='va'>traffic</span> <span class='op'>&lt;-</span> <span class='va'>traffic</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='st'>"Status"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/fifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>Severity</span> <span class='op'>==</span> <span class='st'>"3"</span> <span class='op'>|</span> <span class='va'>Severity</span> <span class='op'>==</span> <span class='st'>"4"</span>, <span class='st'>"Severe"</span>, <span class='st'>"Not Severe"</span><span class='op'>)</span>,
                           levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Not Severe"</span>, <span class='st'>"Severe"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>In this section of data cleaning and pre-processing above, we renamed some of the variables that had their units of measurement for ease of use later in our modeling and for our shinyApp. We took out entries of data that had NAs. If this was a smaller dataset, this may have negatively impacted our analysis, but we dont believe this effected our analysis for this project because even after taking out some data, we had a lot left to work with. Another very important part of this section is that, we took the Severity variable that we are looking at and split it into two to make it into a Categorical variable called Status. Severities 1 and 2 were grouped in to be Not Severe and 3 and 4 were grouped as Severe in the Status variable.</p>
<p><br></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>traffic_time</span> <span class='op'>&lt;-</span> <span class='va'>traffic</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Duration <span class='op'>=</span> <span class='op'>(</span><span class='va'>End_Time</span> <span class='op'>-</span> <span class='va'>Start_Time</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='co'># accident duration should be positive</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='op'>(</span><span class='va'>Duration</span> <span class='op'>&lt;</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>separate</span><span class='op'>(</span><span class='va'>Start_Time</span>, into <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Date"</span>, <span class='st'>"Time"</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='st'>" "</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='st'>"Year"</span> <span class='op'>=</span> <span class='fu'>str_sub</span><span class='op'>(</span><span class='va'>Date</span>, <span class='fl'>1</span>, <span class='fl'>4</span><span class='op'>)</span>, <span class='st'>"Month"</span> <span class='op'>=</span> <span class='fu'>str_sub</span><span class='op'>(</span><span class='va'>Date</span>, <span class='fl'>6</span>, <span class='fl'>7</span><span class='op'>)</span>, <span class='st'>"Day"</span> <span class='op'>=</span> <span class='fu'>str_sub</span><span class='op'>(</span><span class='va'>Date</span>, <span class='fl'>9</span>, <span class='fl'>10</span><span class='op'>)</span>,
         <span class='st'>"Wday"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/IDateTime.html'>wday</a></span><span class='op'>(</span><span class='va'>Date</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='st'>"Hour"</span> <span class='op'>=</span> <span class='fu'>str_sub</span><span class='op'>(</span><span class='va'>Time</span>,<span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Date"</span>, <span class='st'>"Time"</span>, <span class='st'>"End_Time"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>Severity</span>, <span class='va'>Year</span>, <span class='va'>Month</span>, <span class='va'>Day</span>, <span class='va'>Hour</span>, <span class='va'>Wday</span>, <span class='va'>Duration</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>In this section, we used the End_Time and Start_Time variables to come up with several other variables such as Duration, Date, Time, Year, Month, Day, Wday and Hour.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#Drop levels that have less than 20 observations</span>
<span class='va'>weather_to_drop</span> <span class='op'>&lt;-</span>
  <span class='va'>traffic_time</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/count.html'>count</a></span><span class='op'>(</span><span class='va'>Weather_Condition</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>n</span> <span class='op'>&lt;</span> <span class='fl'>20</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>Weather_Condition</span><span class='op'>)</span>

<span class='va'>weather_to_drop</span> <span class='op'>&lt;-</span>
  <span class='va'>weather_to_drop</span><span class='op'>$</span><span class='va'>Weather_Condition</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>traffic_weather</span> <span class='op'>&lt;-</span> <span class='va'>traffic_time</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='op'>(</span><span class='va'>Weather_Condition</span> <span class='op'>%in%</span> <span class='va'>weather_to_drop</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Weather_Condition <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>Weather_Condition</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>traffic2</span> <span class='op'>&lt;-</span> <span class='va'>traffic_weather</span>

<span class='va'>count_city</span> <span class='op'>&lt;-</span> <span class='va'>traffic2</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>City</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarize</a></span><span class='op'>(</span>Count<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>Count</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fl'>950</span><span class='op'>)</span>  

<span class='va'>traffic3</span> <span class='op'>&lt;-</span>
  <span class='va'>traffic2</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>count_city</span>, by<span class='op'>=</span><span class='st'>"City"</span><span class='op'>)</span>

<span class='va'>traffic_final</span> <span class='op'>&lt;-</span>
  <span class='va'>traffic3</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/naniar/man/add_n_miss.html'>add_n_miss</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>n_miss_all</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>n_miss_all</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>Count</span><span class='op'>)</span>

<span class='co'>#write.csv(traffic_final, "traffic_final.csv", row.names = FALSE)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"traffic_final.csv"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 98,088 x 29
   Severity  Year Month Day   Hour   Wday Duration Start_Lat Start_Lng
      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1        2  2016 12    07    23        4     44.4      38.6     -121.
 2        2  2016 12    08    09        5     29.6      38.4     -123.
 3        2  2016 12    23    09        6     29.7      38.3     -123.
 4        2  2017 01    02    19        2     29.7      39.3     -121.
 5        2  2017 01    22    15        1     44.6      38.1     -122.
 6        2  2017 01    23    20        2     29.6      37.2     -122.
 7        2  2017 01    23    22        2     29.8      37.4     -122.
 8        2  2017 01    25    06        4     44.6      38.0     -122.
 9        2  2016 11    30    08        4     70.0      38.7     -122.
10        2  2016 06    21    16        3     60        34.4     -119.
#  with 98,078 more rows, and 20 more variables: Distance &lt;dbl&gt;,
#   Side &lt;chr&gt;, City &lt;chr&gt;, State &lt;chr&gt;, Temperature &lt;dbl&gt;,
#   Wind_Chill &lt;dbl&gt;, Humidity &lt;dbl&gt;, Pressure &lt;dbl&gt;,
#   Visibility &lt;dbl&gt;, Wind_Speed &lt;dbl&gt;, Precipitation &lt;dbl&gt;,
#   Weather_Condition &lt;chr&gt;, Crossing &lt;lgl&gt;, Junction &lt;lgl&gt;,
#   Traffic_Signal &lt;lgl&gt;, Sunrise_Sunset &lt;chr&gt;, Civil_Twilight &lt;chr&gt;,
#   Nautical_Twilight &lt;chr&gt;, Astronomical_Twilight &lt;chr&gt;,
#   Status &lt;chr&gt;</code></pre>
</div>
<p>Upon close examination of the Weather_Conditions variable, we realized that it had a lot of different observations and we wanted to narrow it down. So, we filtered and dropped levels that have less than 20 observations. We had to narrow down the City variable as well. We have over 4000 distinct cities under the top 12 states. Shiny only allows a thousand different observations and so in order for all the top cities to fit in our shiny app, we had to narrow down the list of cities to the top 950.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#modeling pre-process for traffic_final</span>

<span class='va'>traffic_mod</span> <span class='op'>&lt;-</span> <span class='va'>traffic_final</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Status <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>Status</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/naniar/man/where.html'>where</a></span><span class='op'>(</span><span class='va'>is.character</span><span class='op'>)</span>, <span class='va'>as.factor</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>State</span>, <span class='va'>Severity</span>, <span class='va'>Year</span>, <span class='va'>Day</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='co'># select(-arrival_date_year,</span>
  <span class='co'>#        -reservation_status,</span>
  <span class='co'>#        -reservation_status_date) %&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/naniar/man/add_n_miss.html'>add_n_miss</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>n_miss_all</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>n_miss_all</span><span class='op'>)</span>


<span class='va'>traffic_mod</span><span class='op'>$</span><span class='va'>Crossing</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>traffic_mod</span><span class='op'>$</span><span class='va'>Crossing</span><span class='op'>)</span>
<span class='va'>traffic_mod</span><span class='op'>$</span><span class='va'>Month</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>traffic_mod</span><span class='op'>$</span><span class='va'>Month</span><span class='op'>)</span>
<span class='va'>traffic_mod</span><span class='op'>$</span><span class='va'>Wday</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>traffic_mod</span><span class='op'>$</span><span class='va'>Wday</span><span class='op'>)</span>
<span class='va'>traffic_mod</span><span class='op'>$</span><span class='va'>Hour</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>traffic_mod</span><span class='op'>$</span><span class='va'>Hour</span><span class='op'>)</span>
<span class='va'>traffic_mod</span><span class='op'>$</span><span class='va'>Duration</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>traffic_mod</span><span class='op'>$</span><span class='va'>Duration</span><span class='op'>)</span>
<span class='va'>traffic_mod</span><span class='op'>$</span><span class='va'>Junction</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>traffic_mod</span><span class='op'>$</span><span class='va'>Junction</span><span class='op'>)</span>
<span class='va'>traffic_mod</span><span class='op'>$</span><span class='va'>Traffic_Signal</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>traffic_mod</span><span class='op'>$</span><span class='va'>Traffic_Signal</span><span class='op'>)</span>
 

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>494</span><span class='op'>)</span> <span class='co'>#for reproducibility</span>

<span class='co'># Randomly assigns 75% of the data to training.</span>
<span class='va'>traffic_split</span> <span class='op'>&lt;-</span> <span class='fu'>initial_split</span><span class='op'>(</span><span class='va'>traffic_mod</span>,
                             prop <span class='op'>=</span> <span class='fl'>.50</span><span class='op'>)</span>
<span class='va'>traffic_split</span>
</code></pre>
</div>
<pre><code>&lt;Analysis/Assess/Total&gt;
&lt;49044/49044/98088&gt;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>traffic_training</span> <span class='op'>&lt;-</span> <span class='fu'>training</span><span class='op'>(</span><span class='va'>traffic_split</span><span class='op'>)</span>
<span class='va'>traffic_testing</span> <span class='op'>&lt;-</span> <span class='fu'>testing</span><span class='op'>(</span><span class='va'>traffic_split</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Here, we get the data ready for the modeling part by taking the non-predictive variables out of our data set, and converting the predictors data type into the correct type. After that, we split our data into testing and training data according to a 50 percentage split.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#lasso</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>494</span><span class='op'>)</span>

<span class='va'>lasso_recipe</span> <span class='op'>&lt;-</span>
  <span class='fu'>recipe</span><span class='op'>(</span><span class='va'>Status</span> <span class='op'>~</span> <span class='va'>.</span>,
         data <span class='op'>=</span> <span class='va'>traffic_training</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='co'># step_mutate(County,</span>
  <span class='co'>#              County = fct_lump_n(County, n = 5)) %&gt;%</span>
   <span class='fu'>step_mutate</span><span class='op'>(</span><span class='va'>City</span>,
               City <span class='op'>=</span> <span class='fu'>fct_lump_n</span><span class='op'>(</span><span class='va'>City</span>, n <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>step_normalize</span><span class='op'>(</span><span class='fu'>all_predictors</span><span class='op'>(</span><span class='op'>)</span>,
                 <span class='op'>-</span><span class='fu'>all_nominal</span><span class='op'>(</span><span class='op'>)</span>,
                 <span class='op'>-</span><span class='fu'>all_outcomes</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>step_dummy</span><span class='op'>(</span><span class='fu'>all_nominal</span><span class='op'>(</span><span class='op'>)</span>,
             <span class='op'>-</span><span class='fu'>all_outcomes</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>lasso_recipe</span> <span class='op'>%&gt;%</span>
  <span class='fu'>prep</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>juice</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 49,044 x 64
    Month    Hour    Wday Duration Start_Lat Start_Lng Distance
    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1  1.21   1.86   -0.0289  -0.0345     0.715     -1.31   -0.252
 2  1.21  -0.527   0.536   -0.0399     0.682     -1.38   -0.252
 3  1.21  -0.527   1.10    -0.0399     0.665     -1.38   -0.260
 4 -1.93   0.495  -1.72    -0.0344     0.621     -1.36   -0.252
 5 -1.93   1.69   -1.16    -0.0398     0.464     -1.34   -0.252
 6 -0.504 -0.527  -1.16    -0.0366    -0.161     -1.15   -0.260
 7 -0.219 -1.04    1.67    -0.0342    -0.155     -1.15   -0.260
 8 -0.219 -1.89   -0.594   -0.0287    -0.141     -1.16   -0.260
 9 -0.219 -0.0158 -0.0289  -0.0368    -0.178     -1.17   -0.260
10 -0.219  1.35   -0.0289  -0.0398    -0.179     -1.16   -0.260
#  with 49,034 more rows, and 57 more variables: Temperature &lt;dbl&gt;,
#   Wind_Chill &lt;dbl&gt;, Humidity &lt;dbl&gt;, Pressure &lt;dbl&gt;,
#   Visibility &lt;dbl&gt;, Wind_Speed &lt;dbl&gt;, Precipitation &lt;dbl&gt;,
#   Status &lt;fct&gt;, Side_R &lt;dbl&gt;, City_Dallas &lt;dbl&gt;,
#   City_Houston &lt;dbl&gt;, City_Los.Angeles &lt;dbl&gt;, City_Miami &lt;dbl&gt;,
#   City_Other &lt;dbl&gt;, Weather_Condition_Cloudy &lt;dbl&gt;,
#   Weather_Condition_Cloudy...Windy &lt;dbl&gt;,
#   Weather_Condition_Drizzle &lt;dbl&gt;, Weather_Condition_Fair &lt;dbl&gt;,
#   Weather_Condition_Fair...Windy &lt;dbl&gt;,
#   Weather_Condition_Fog &lt;dbl&gt;, Weather_Condition_Haze &lt;dbl&gt;,
#   Weather_Condition_Heavy.Rain &lt;dbl&gt;,
#   Weather_Condition_Heavy.Rain...Windy &lt;dbl&gt;,
#   Weather_Condition_Heavy.Snow &lt;dbl&gt;,
#   Weather_Condition_Heavy.T.Storm &lt;dbl&gt;,
#   Weather_Condition_Light.Drizzle &lt;dbl&gt;,
#   Weather_Condition_Light.Freezing.Rain &lt;dbl&gt;,
#   Weather_Condition_Light.Rain &lt;dbl&gt;,
#   Weather_Condition_Light.Rain...Windy &lt;dbl&gt;,
#   Weather_Condition_Light.Rain.with.Thunder &lt;dbl&gt;,
#   Weather_Condition_Light.Snow &lt;dbl&gt;,
#   Weather_Condition_Light.Snow...Windy &lt;dbl&gt;,
#   Weather_Condition_Mist &lt;dbl&gt;,
#   Weather_Condition_Mostly.Cloudy &lt;dbl&gt;,
#   Weather_Condition_Mostly.Cloudy...Windy &lt;dbl&gt;,
#   Weather_Condition_N.A.Precipitation &lt;dbl&gt;,
#   Weather_Condition_Overcast &lt;dbl&gt;,
#   Weather_Condition_Partly.Cloudy &lt;dbl&gt;,
#   Weather_Condition_Partly.Cloudy...Windy &lt;dbl&gt;,
#   Weather_Condition_Patches.of.Fog &lt;dbl&gt;,
#   Weather_Condition_Rain &lt;dbl&gt;,
#   Weather_Condition_Rain...Windy &lt;dbl&gt;,
#   Weather_Condition_Scattered.Clouds &lt;dbl&gt;,
#   Weather_Condition_Shallow.Fog &lt;dbl&gt;,
#   Weather_Condition_Smoke &lt;dbl&gt;, Weather_Condition_Snow &lt;dbl&gt;,
#   Weather_Condition_T.Storm &lt;dbl&gt;, Weather_Condition_Thunder &lt;dbl&gt;,
#   Weather_Condition_Thunder.in.the.Vicinity &lt;dbl&gt;,
#   Weather_Condition_Wintry.Mix &lt;dbl&gt;, Crossing_TRUE. &lt;dbl&gt;,
#   Junction_TRUE. &lt;dbl&gt;, Traffic_Signal_TRUE. &lt;dbl&gt;,
#   Sunrise_Sunset_Night &lt;dbl&gt;, Civil_Twilight_Night &lt;dbl&gt;,
#   Nautical_Twilight_Night &lt;dbl&gt;, Astronomical_Twilight_Night &lt;dbl&gt;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>lasso_mod</span> <span class='op'>&lt;-</span>
  <span class='fu'>logistic_reg</span><span class='op'>(</span>mixture <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>set_engine</span><span class='op'>(</span><span class='st'>"glmnet"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>set_args</span><span class='op'>(</span>penalty <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>set_mode</span><span class='op'>(</span><span class='st'>"classification"</span><span class='op'>)</span>

<span class='va'>lasso_wf</span> <span class='op'>&lt;-</span>
  <span class='fu'>workflow</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>add_recipe</span><span class='op'>(</span><span class='va'>lasso_recipe</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>add_model</span><span class='op'>(</span><span class='va'>lasso_mod</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>494</span><span class='op'>)</span> <span class='co'>#for reproducible 5-fold</span>
<span class='va'>traffic_cv</span> <span class='op'>&lt;-</span> <span class='fu'>vfold_cv</span><span class='op'>(</span><span class='va'>traffic_training</span>,
                       v <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>

<span class='va'>penalty_grid</span> <span class='op'>&lt;-</span> <span class='fu'>grid_regular</span><span class='op'>(</span><span class='fu'>penalty</span><span class='op'>(</span><span class='op'>)</span>,
                             levels <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>

<span class='co'># add ctrl_grid - assures predictions and workflows are saved</span>
<span class='va'>ctrl_grid</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/stacks/man/control_stack.html'>control_stack_resamples</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>metric</span> <span class='op'>&lt;-</span> <span class='fu'>metric_set</span><span class='op'>(</span><span class='va'>accuracy</span><span class='op'>)</span>

<span class='co'># tune the model</span>
<span class='va'>lasso_tune</span> <span class='op'>&lt;-</span>
  <span class='va'>lasso_wf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>tune_grid</span><span class='op'>(</span>
    resamples <span class='op'>=</span> <span class='va'>traffic_cv</span>,
    grid <span class='op'>=</span> <span class='va'>penalty_grid</span>,
    control <span class='op'>=</span> <span class='va'>ctrl_grid</span>
    <span class='op'>)</span>

<span class='va'>lasso_tune</span> <span class='op'>%&gt;%</span>
  <span class='fu'>collect_metrics</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 20 x 7
       penalty .metric  .estimator  mean     n std_err .config        
         &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;          
 1    1.00e-10 accuracy binary     0.808     5 1.52e-3 Preprocessor1_
 2    1.00e-10 roc_auc  binary     0.738     5 7.72e-4 Preprocessor1_
 3    1.29e- 9 accuracy binary     0.808     5 1.52e-3 Preprocessor1_
 4    1.29e- 9 roc_auc  binary     0.738     5 7.72e-4 Preprocessor1_
 5    1.67e- 8 accuracy binary     0.808     5 1.52e-3 Preprocessor1_
 6    1.67e- 8 roc_auc  binary     0.738     5 7.72e-4 Preprocessor1_
 7    2.15e- 7 accuracy binary     0.808     5 1.52e-3 Preprocessor1_
 8    2.15e- 7 roc_auc  binary     0.738     5 7.72e-4 Preprocessor1_
 9    2.78e- 6 accuracy binary     0.808     5 1.52e-3 Preprocessor1_
10    2.78e- 6 roc_auc  binary     0.738     5 7.72e-4 Preprocessor1_
11    3.59e- 5 accuracy binary     0.808     5 1.53e-3 Preprocessor1_
12    3.59e- 5 roc_auc  binary     0.738     5 7.75e-4 Preprocessor1_
13    4.64e- 4 accuracy binary     0.808     5 1.69e-3 Preprocessor1_
14    4.64e- 4 roc_auc  binary     0.737     5 9.58e-4 Preprocessor1_
15    5.99e- 3 accuracy binary     0.807     5 2.46e-3 Preprocessor1_
16    5.99e- 3 roc_auc  binary     0.730     5 2.33e-3 Preprocessor1_
17    7.74e- 2 accuracy binary     0.806     5 2.34e-3 Preprocessor1_
18    7.74e- 2 roc_auc  binary     0.5       5 0.      Preprocessor1_
19    1.00e+ 0 accuracy binary     0.806     5 2.34e-3 Preprocessor1_
20    1.00e+ 0 roc_auc  binary     0.5       5 0.      Preprocessor1_</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>best_param</span> <span class='op'>&lt;-</span> <span class='va'>lasso_tune</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select_best</span><span class='op'>(</span>metric <span class='op'>=</span> <span class='st'>"accuracy"</span><span class='op'>)</span>
<span class='va'>best_param</span>
</code></pre>
</div>
<pre><code># A tibble: 1 x 2
   penalty .config              
     &lt;dbl&gt; &lt;chr&gt;                
1 0.000464 Preprocessor1_Model07</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>final_lasso</span> <span class='op'>&lt;-</span> <span class='va'>lasso_wf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>finalize_workflow</span><span class='op'>(</span><span class='va'>best_param</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>fit</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>traffic_training</span><span class='op'>)</span>

<span class='va'>final_lasso</span> <span class='op'>%&gt;%</span>
  <span class='fu'>pull_workflow_fit</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://generics.r-lib.org/reference/tidy.html'>tidy</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 64 x 3
   term         estimate  penalty
   &lt;chr&gt;           &lt;dbl&gt;    &lt;dbl&gt;
 1 (Intercept) -3.56     0.000464
 2 Month       -0.353    0.000464
 3 Hour         0.0587   0.000464
 4 Wday        -0.000337 0.000464
 5 Duration     0        0.000464
 6 Start_Lat    0.135    0.000464
 7 Start_Lng    0.462    0.000464
 8 Distance     0.0946   0.000464
 9 Temperature  0.224    0.000464
10 Wind_Chill  -0.0209   0.000464
#  with 54 more rows</code></pre>
</div>
<p>The first model we build is a classification LASSO model, which selects the variables based on the magnitude of their coefficients. We tuned the LASSO model using a level 10 panelty grid, and selected the tuning parameter with the best prediction accuracy as the parameter for the final model. The accuracy for the best LASSO model is 80.956%, which means that the LASSO model predicts the right severity level 80.956% of the times.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#classification rf</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>494</span><span class='op'>)</span>

<span class='va'>rf_recipe</span> <span class='op'>&lt;-</span>
  <span class='fu'>recipe</span><span class='op'>(</span><span class='va'>Status</span> <span class='op'>~</span> <span class='va'>.</span>,
         data <span class='op'>=</span> <span class='va'>traffic_training</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>step_mutate_at</span><span class='op'>(</span><span class='fu'>all_numeric</span><span class='op'>(</span><span class='op'>)</span>,
                 fn <span class='op'>=</span> <span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>rf_recipe</span> <span class='op'>%&gt;%</span>
  <span class='fu'>prep</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>juice</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 49,044 x 25
   Month  Hour  Wday Duration Start_Lat Start_Lng Distance Side  City 
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;
 1    12    24     4     44.4      38.6     -121.     0.01 R     Sacr
 2    12    10     5     29.6      38.4     -123.     0.01 R     Sant
 3    12    10     6     29.7      38.3     -123.     0    L     Seba
 4     1    16     1     44.6      38.1     -122.     0.01 R     Peta
 5     1    23     2     29.8      37.4     -122.     0.01 L     Sant
 6     6    10     2     38.6      34.4     -119.     0    R     Newh
 7     7     7     7     45        34.4     -119.     0    R     Vale
 8     7     2     3     60        34.5     -119.     0    L     Cast
 9     7    13     4     38.1      34.3     -119.     0    R     Simi
10     7    21     4     30        34.3     -119.     0    R     Simi
#  with 49,034 more rows, and 16 more variables: Temperature &lt;dbl&gt;,
#   Wind_Chill &lt;dbl&gt;, Humidity &lt;dbl&gt;, Pressure &lt;dbl&gt;,
#   Visibility &lt;dbl&gt;, Wind_Speed &lt;dbl&gt;, Precipitation &lt;dbl&gt;,
#   Weather_Condition &lt;fct&gt;, Crossing &lt;fct&gt;, Junction &lt;fct&gt;,
#   Traffic_Signal &lt;fct&gt;, Sunrise_Sunset &lt;fct&gt;, Civil_Twilight &lt;fct&gt;,
#   Nautical_Twilight &lt;fct&gt;, Astronomical_Twilight &lt;fct&gt;,
#   Status &lt;fct&gt;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rf_model</span> <span class='op'>&lt;-</span>
  <span class='fu'>rand_forest</span><span class='op'>(</span>mtry <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span>,
              min_n <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span>,
              trees <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>set_mode</span><span class='op'>(</span><span class='st'>"classification"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>set_engine</span><span class='op'>(</span><span class='st'>"ranger"</span><span class='op'>)</span>


<span class='va'>rf_workflow</span> <span class='op'>&lt;-</span>
  <span class='fu'>workflow</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>add_recipe</span><span class='op'>(</span><span class='va'>rf_recipe</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>add_model</span><span class='op'>(</span><span class='va'>rf_model</span><span class='op'>)</span>


<span class='va'>rf_penalty_grid</span> <span class='op'>&lt;-</span>
  <span class='fu'>grid_regular</span><span class='op'>(</span><span class='fu'>finalize</span><span class='op'>(</span><span class='fu'>mtry</span><span class='op'>(</span><span class='op'>)</span>,
                        <span class='va'>traffic_training</span> <span class='op'>%&gt;%</span>
                          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>Status</span><span class='op'>)</span><span class='op'>)</span>,
               <span class='fu'>min_n</span><span class='op'>(</span><span class='op'>)</span>,
               levels <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>


<span class='co'># traffic_cv &lt;- vfold_cv(traffic_training,</span>
<span class='co'>#                        v = 5)</span>

<span class='va'>rf_tune</span> <span class='op'>&lt;-</span>
  <span class='va'>rf_workflow</span> <span class='op'>%&gt;%</span>
  <span class='fu'>tune_grid</span><span class='op'>(</span>
    resamples <span class='op'>=</span> <span class='va'>traffic_cv</span>,
    grid <span class='op'>=</span> <span class='va'>rf_penalty_grid</span>,
    control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/stacks/man/control_stack.html'>control_stack_grid</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>)</span>

<span class='va'>rf_tune</span> <span class='op'>%&gt;%</span>
  <span class='fu'>collect_metrics</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 18 x 8
    mtry min_n .metric  .estimator  mean     n std_err .config        
   &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;          
 1     1     2 accuracy binary     0.806     5 0.00225 Preprocessor1_
 2     1     2 roc_auc  binary     0.786     5 0.00307 Preprocessor1_
 3    12     2 accuracy binary     0.842     5 0.00184 Preprocessor1_
 4    12     2 roc_auc  binary     0.851     5 0.00291 Preprocessor1_
 5    24     2 accuracy binary     0.841     5 0.00267 Preprocessor1_
 6    24     2 roc_auc  binary     0.848     5 0.00259 Preprocessor1_
 7     1    21 accuracy binary     0.807     5 0.00210 Preprocessor1_
 8     1    21 roc_auc  binary     0.796     5 0.00191 Preprocessor1_
 9    12    21 accuracy binary     0.846     5 0.00172 Preprocessor1_
10    12    21 roc_auc  binary     0.868     5 0.00193 Preprocessor1_
11    24    21 accuracy binary     0.844     5 0.00125 Preprocessor1_
12    24    21 roc_auc  binary     0.862     5 0.00229 Preprocessor1_
13     1    40 accuracy binary     0.807     5 0.00210 Preprocessor1_
14     1    40 roc_auc  binary     0.788     5 0.00353 Preprocessor1_
15    12    40 accuracy binary     0.848     5 0.00105 Preprocessor1_
16    12    40 roc_auc  binary     0.872     5 0.00170 Preprocessor1_
17    24    40 accuracy binary     0.844     5 0.00189 Preprocessor1_
18    24    40 roc_auc  binary     0.866     5 0.00212 Preprocessor1_</code></pre>
</div>
<p>After conducting the LASSO model, we also build the random forest model, which builds 10 trees and gives out the mode of the predictions of these 10 trees. We thought that this model might be more accurate than the LASSO model although it is also more computationally inefficient. We used a panelty grid of level 3 to tune our random forest model, and the tuning parameter with the largest accuracy is with <code>mtry</code> = 12 and <code>min_n</code> = 40. The largest accuracy is 84.693%, which is higher than the LASSO model.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#decision trees</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>494</span><span class='op'>)</span>

<span class='va'>tree_model</span> <span class='op'>&lt;-</span>
  <span class='fu'>decision_tree</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>set_mode</span><span class='op'>(</span><span class='st'>"classification"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>set_engine</span><span class='op'>(</span><span class='st'>"rpart"</span><span class='op'>)</span>

<span class='va'>tree_workflow</span> <span class='op'>&lt;-</span>
  <span class='fu'>workflow</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>add_recipe</span><span class='op'>(</span><span class='va'>rf_recipe</span><span class='op'>)</span> <span class='op'>%&gt;%</span>  
  <span class='fu'>add_model</span><span class='op'>(</span><span class='va'>tree_model</span><span class='op'>)</span>

<span class='va'>tree_fit</span> <span class='op'>&lt;-</span>
  <span class='va'>tree_workflow</span> <span class='op'>%&gt;%</span>
  <span class='fu'>fit_resamples</span><span class='op'>(</span><span class='va'>traffic_cv</span>,
                <span class='co'># metrics = metric,</span>
                control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/stacks/man/control_stack.html'>control_stack_resamples</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>)</span>

<span class='fu'>collect_metrics</span><span class='op'>(</span><span class='va'>tree_fit</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 2 x 6
  .metric  .estimator  mean     n std_err .config             
  &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 accuracy binary     0.824     5 0.00143 Preprocessor1_Model1
2 roc_auc  binary     0.686     5 0.00309 Preprocessor1_Model1</code></pre>
</div>
<p>Finally, in order to create a stacked model, we build a third model which is just a simple classification decision tree. The accuracy for the decision tree model is 82.559%, which is also higher than the LASSO.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># model stacking</span>
<span class='va'>lasso_tune</span> <span class='op'>%&gt;%</span>
  <span class='fu'>collect_metrics</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 20 x 7
       penalty .metric  .estimator  mean     n std_err .config        
         &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;          
 1    1.00e-10 accuracy binary     0.808     5 1.52e-3 Preprocessor1_
 2    1.00e-10 roc_auc  binary     0.738     5 7.72e-4 Preprocessor1_
 3    1.29e- 9 accuracy binary     0.808     5 1.52e-3 Preprocessor1_
 4    1.29e- 9 roc_auc  binary     0.738     5 7.72e-4 Preprocessor1_
 5    1.67e- 8 accuracy binary     0.808     5 1.52e-3 Preprocessor1_
 6    1.67e- 8 roc_auc  binary     0.738     5 7.72e-4 Preprocessor1_
 7    2.15e- 7 accuracy binary     0.808     5 1.52e-3 Preprocessor1_
 8    2.15e- 7 roc_auc  binary     0.738     5 7.72e-4 Preprocessor1_
 9    2.78e- 6 accuracy binary     0.808     5 1.52e-3 Preprocessor1_
10    2.78e- 6 roc_auc  binary     0.738     5 7.72e-4 Preprocessor1_
11    3.59e- 5 accuracy binary     0.808     5 1.53e-3 Preprocessor1_
12    3.59e- 5 roc_auc  binary     0.738     5 7.75e-4 Preprocessor1_
13    4.64e- 4 accuracy binary     0.808     5 1.69e-3 Preprocessor1_
14    4.64e- 4 roc_auc  binary     0.737     5 9.58e-4 Preprocessor1_
15    5.99e- 3 accuracy binary     0.807     5 2.46e-3 Preprocessor1_
16    5.99e- 3 roc_auc  binary     0.730     5 2.33e-3 Preprocessor1_
17    7.74e- 2 accuracy binary     0.806     5 2.34e-3 Preprocessor1_
18    7.74e- 2 roc_auc  binary     0.5       5 0.      Preprocessor1_
19    1.00e+ 0 accuracy binary     0.806     5 2.34e-3 Preprocessor1_
20    1.00e+ 0 roc_auc  binary     0.5       5 0.      Preprocessor1_</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rf_tune</span> <span class='op'>%&gt;%</span>
  <span class='fu'>collect_metrics</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 18 x 8
    mtry min_n .metric  .estimator  mean     n std_err .config        
   &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;          
 1     1     2 accuracy binary     0.806     5 0.00225 Preprocessor1_
 2     1     2 roc_auc  binary     0.786     5 0.00307 Preprocessor1_
 3    12     2 accuracy binary     0.842     5 0.00184 Preprocessor1_
 4    12     2 roc_auc  binary     0.851     5 0.00291 Preprocessor1_
 5    24     2 accuracy binary     0.841     5 0.00267 Preprocessor1_
 6    24     2 roc_auc  binary     0.848     5 0.00259 Preprocessor1_
 7     1    21 accuracy binary     0.807     5 0.00210 Preprocessor1_
 8     1    21 roc_auc  binary     0.796     5 0.00191 Preprocessor1_
 9    12    21 accuracy binary     0.846     5 0.00172 Preprocessor1_
10    12    21 roc_auc  binary     0.868     5 0.00193 Preprocessor1_
11    24    21 accuracy binary     0.844     5 0.00125 Preprocessor1_
12    24    21 roc_auc  binary     0.862     5 0.00229 Preprocessor1_
13     1    40 accuracy binary     0.807     5 0.00210 Preprocessor1_
14     1    40 roc_auc  binary     0.788     5 0.00353 Preprocessor1_
15    12    40 accuracy binary     0.848     5 0.00105 Preprocessor1_
16    12    40 roc_auc  binary     0.872     5 0.00170 Preprocessor1_
17    24    40 accuracy binary     0.844     5 0.00189 Preprocessor1_
18    24    40 roc_auc  binary     0.866     5 0.00212 Preprocessor1_</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tree_fit</span> <span class='op'>%&gt;%</span>
  <span class='fu'>collect_metrics</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 2 x 6
  .metric  .estimator  mean     n std_err .config             
  &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 accuracy binary     0.824     5 0.00143 Preprocessor1_Model1
2 roc_auc  binary     0.686     5 0.00309 Preprocessor1_Model1</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>traffic_stack</span> <span class='op'>&lt;-</span>
  <span class='fu'><a href='https://rdrr.io/pkg/stacks/man/stacks.html'>stacks</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/stacks/man/add_candidates.html'>add_candidates</a></span><span class='op'>(</span><span class='va'>lasso_tune</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/stacks/man/add_candidates.html'>add_candidates</a></span><span class='op'>(</span><span class='va'>rf_tune</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/stacks/man/add_candidates.html'>add_candidates</a></span><span class='op'>(</span><span class='va'>tree_fit</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>traffic_blend</span> <span class='op'>&lt;-</span>
  <span class='va'>traffic_stack</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/stacks/man/blend_predictions.html'>blend_predictions</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>traffic_blend</span>
</code></pre>
</div>
<pre><code># A tibble: 9 x 3
  member                    type          weight
  &lt;chr&gt;                     &lt;chr&gt;          &lt;dbl&gt;
1 .pred_Severe_rf_tune_1_8  rand_forest    1.80 
2 .pred_Severe_rf_tune_1_5  rand_forest    1.47 
3 .pred_Severe_rf_tune_1_2  rand_forest    0.871
4 .pred_Severe_tree_fit_1_1 decision_tree  0.783
5 .pred_Severe_rf_tune_1_9  rand_forest    0.642
6 .pred_Severe_rf_tune_1_4  rand_forest    0.639
7 .pred_Severe_rf_tune_1_3  rand_forest    0.604
8 .pred_Severe_rf_tune_1_6  rand_forest    0.578
9 .pred_Severe_rf_tune_1_7  rand_forest    0.225</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>traffic_final_stack</span> <span class='op'>&lt;-</span> <span class='va'>traffic_blend</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/stacks/man/fit_members.html'>fit_members</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='co'>#saveRDS(traffic_final_stack, "traffic_final_stacked.rds")</span>
</code></pre>
</div>
</div>
<h2 id="shiny-app">Shiny App</h2>
<h3 id="user-interface-ui">User Interface (UI)</h3>
<p>We also developed a shiny app that included all of the relevant variables of our analysis. The purpose of the app was to allow the user to plug different values for environmental conditions or locations to see how the severity predicted changes. When creating the UI, we decided to use sliders for each of the numerical variables. The sliders referenced minimum and maximum variables that I had defined previously in line 553. For variables with multiple levels like City and Weather condition, we decided to create a list of levels that we referenced later in the selectInput function. This saved us the time of having to type the name of each of the variables levels. We also formatted the app using the bslib package, we included this in the theme argument in line 566. We used the package to define a font, the primary, secondary and bootswatch colors. Given the large number of variables included, we also added a scrollable side panel in lineS 577 to 580.</p>
<h3 id="server">Server</h3>
<p>We then defined the input variables for the server. We run into errors regarding incoherence between the variables used in the UI and the server. We decided to assign arbitrary values to the input variables and one by one we tested what variables were not being recognized. This also allowed us to detect certain variables that we no longer considered relevant, like county. We also had to pre-processing to change the names of variables like wind_chill(F) which were for some reason not recognized by the tibble function. Then, in lines 836 - 840 we defined the output by using the stacked model in our data and asked the app to show our prediction.</p>
<h3 id="embedded-app">Embedded app</h3>
<p>We decided to use an embedded app in a different r-markdown file considering that the size of our rsd file (our model) was too big to be deployed. We added a runtime: shiny argument in the YAML. Within an r code chunk, we still had to call the lists of variable levels and the minimum and maximum variable values before copying the code for our app. We used the shinyApp function in line 564 before plugging the remainder of our code. The app works but it could only be seen by people that have R installed in the computers and that have the project file. This is an issue that we further need to work on. We believe there are ways to reduce the size of our rsd file.</p>
<h3 id="shiny-app-code">Shiny App Code</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># traffic_mod &lt;- readRDS("traffic_final_stacked.rds")</span>
<span class='co'># traffic_mod &lt;- readRDS("traffic_final_stacked.rds")</span>
<span class='co'># </span>
<span class='co'># Cities &lt;-</span>
<span class='co'>#   traffic_mod$train  %&gt;%</span>
<span class='co'>#   select(City) %&gt;%</span>
<span class='co'>#   distinct(City) %&gt;%</span>
<span class='co'>#   arrange(City) %&gt;%</span>
<span class='co'>#   pull(City)</span>
<span class='co'># </span>
<span class='co'># Weather &lt;-</span>
<span class='co'>#   traffic_mod$train  %&gt;%</span>
<span class='co'>#   select(Weather_Condition) %&gt;%</span>
<span class='co'>#   distinct(Weather_Condition) %&gt;%</span>
<span class='co'>#   arrange(Weather_Condition) %&gt;%</span>
<span class='co'>#   pull(Weather_Condition)</span>
<span class='co'># </span>
<span class='co'># </span>
<span class='co'># # Find min's, max's, and median's for quantitative vars:</span>
<span class='co'># </span>
<span class='co'># stats_num &lt;-</span>
<span class='co'>#   traffic_mod$train  %&gt;%</span>
<span class='co'>#   select(where(is.numeric)) %&gt;%</span>
<span class='co'>#   pivot_longer(cols = everything(),</span>
<span class='co'>#                names_to = "variable",</span>
<span class='co'>#                values_to = "value") %&gt;%</span>
<span class='co'>#   group_by(variable) %&gt;%</span>
<span class='co'>#   summarize(min_val = min(value),</span>
<span class='co'>#             max_val = max(value),</span>
<span class='co'>#             med_val = median(value))</span>
<span class='co'># </span>
<span class='co'># shinyApp(</span>
<span class='co'>#   ui &lt;- fluidPage(</span>
<span class='co'>#   theme = bs_theme(primary = "#123B60",</span>
<span class='co'>#                    secondary = "#D44420",</span>
<span class='co'>#                    base_font = list(font_google("Raleway"), "-apple-system",</span>
<span class='co'>#                                     "BlinkMacSystemFont", "Segoe UI", "Helvetica Neue", "Arial",</span>
<span class='co'>#                                     "sans-serif", "Apple Color Emoji", "Segoe UI Emoji",</span>
<span class='co'>#                                     "Segoe UI Symbol"),</span>
<span class='co'>#                    bootswatch = "sandstone"),</span>
<span class='co'>#   # Application title</span>
<span class='co'>#   sidebarLayout(</span>
<span class='co'>#     sidebarPanel(</span>
<span class='co'>#       # added this for scrollable side panel:</span>
<span class='co'>#       tags$head(tags$style(</span>
<span class='co'>#         type = 'text/css',</span>
<span class='co'>#         'form.well { max-height: 600px; overflow-y: auto; }'</span>
<span class='co'>#       )),</span>
<span class='co'>#       sliderInput(inputId = "Hour",</span>
<span class='co'>#               label = "Hour of Accident",</span>
<span class='co'>#               min = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Hour") %&gt;%</span>
<span class='co'>#                 pull(min_val),</span>
<span class='co'>#               max = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Hour") %&gt;%</span>
<span class='co'>#                 pull(max_val),</span>
<span class='co'>#               value = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Hour") %&gt;%</span>
<span class='co'>#                 pull(med_val),</span>
<span class='co'>#               step = 1,</span>
<span class='co'>#               round = TRUE),</span>
<span class='co'>#       sliderInput(inputId = "Month",</span>
<span class='co'>#               label = "Month of Accident",</span>
<span class='co'>#               min = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Month") %&gt;%</span>
<span class='co'>#                 pull(min_val),</span>
<span class='co'>#               max = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Month") %&gt;%</span>
<span class='co'>#                 pull(max_val),</span>
<span class='co'>#               value = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Month") %&gt;%</span>
<span class='co'>#                 pull(med_val),</span>
<span class='co'>#               step = 1,</span>
<span class='co'>#               round = TRUE),</span>
<span class='co'>#       sliderInput(inputId = "Wday",</span>
<span class='co'>#               label = "Week day of Accident",</span>
<span class='co'>#               min = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Wday") %&gt;%</span>
<span class='co'>#                 pull(min_val),</span>
<span class='co'>#               max = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Wday") %&gt;%</span>
<span class='co'>#                 pull(max_val),</span>
<span class='co'>#               value = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Wday") %&gt;%</span>
<span class='co'>#                 pull(med_val),</span>
<span class='co'>#               step = 1,</span>
<span class='co'>#               round = TRUE),</span>
<span class='co'>#       sliderInput(inputId = "Duration",</span>
<span class='co'>#               label = "Duration of Accident in seconds",</span>
<span class='co'>#               min = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Duration") %&gt;%</span>
<span class='co'>#                 pull(min_val),</span>
<span class='co'>#               max = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Duration") %&gt;%</span>
<span class='co'>#                 pull(max_val),</span>
<span class='co'>#               value = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Duration") %&gt;%</span>
<span class='co'>#                 pull(med_val),</span>
<span class='co'>#               step = 1,</span>
<span class='co'>#               round = TRUE),</span>
<span class='co'>#       sliderInput(inputId = "Start_Lat",</span>
<span class='co'>#               label = "Starting latitude of the Accident",</span>
<span class='co'>#               min = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Start_Lat") %&gt;%</span>
<span class='co'>#                 pull(min_val),</span>
<span class='co'>#               max = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Start_Lat") %&gt;%</span>
<span class='co'>#                 pull(max_val),</span>
<span class='co'>#               value = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Start_Lat") %&gt;%</span>
<span class='co'>#                 pull(med_val),</span>
<span class='co'>#               step = 1,</span>
<span class='co'>#               round = TRUE),</span>
<span class='co'>#       sliderInput(inputId = "Start_Lng",</span>
<span class='co'>#               label = "Starting longitude of the Accident",</span>
<span class='co'>#               min = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Start_Lng") %&gt;%</span>
<span class='co'>#                 pull(min_val),</span>
<span class='co'>#               max = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Start_Lng") %&gt;%</span>
<span class='co'>#                 pull(max_val),</span>
<span class='co'>#               value = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Start_Lng") %&gt;%</span>
<span class='co'>#                 pull(med_val),</span>
<span class='co'>#               step = 1,</span>
<span class='co'>#               round = TRUE),</span>
<span class='co'>#       sliderInput(inputId = "Distance",</span>
<span class='co'>#               label = "Distance of the Accident",</span>
<span class='co'>#               min = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Distance") %&gt;%</span>
<span class='co'>#                 pull(min_val),</span>
<span class='co'>#               max = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Distance") %&gt;%</span>
<span class='co'>#                 pull(max_val),</span>
<span class='co'>#               value = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Distance") %&gt;%</span>
<span class='co'>#                 pull(med_val),</span>
<span class='co'>#               step = 1,</span>
<span class='co'>#               round = TRUE),</span>
<span class='co'>#       selectInput(inputId = "Side",</span>
<span class='co'>#               label = "Side of the street where the accident happened",</span>
<span class='co'>#               choices = list(Right = "R",</span>
<span class='co'>#                              Left = "L")),</span>
<span class='co'>#       selectInput(inputId = "City",</span>
<span class='co'>#                   label = "City where the accident happened",</span>
<span class='co'>#                   choices = Cities),</span>
<span class='co'>#       sliderInput(inputId = "Temperature",</span>
<span class='co'>#               label = "Temperature when accident happened",</span>
<span class='co'>#               min = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Temperature") %&gt;%</span>
<span class='co'>#                 pull(min_val),</span>
<span class='co'>#               max = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Temperature") %&gt;%</span>
<span class='co'>#                 pull(max_val),</span>
<span class='co'>#               value = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Temperature") %&gt;%</span>
<span class='co'>#                 pull(med_val),</span>
<span class='co'>#               step = 1,</span>
<span class='co'>#               round = TRUE),</span>
<span class='co'>#       sliderInput(inputId = "Wind_Chill",</span>
<span class='co'>#               label = "Wind chill in degrees Farenheit when accident happened",</span>
<span class='co'>#               min = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Wind_Chill") %&gt;%</span>
<span class='co'>#                 pull(min_val),</span>
<span class='co'>#               max = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Wind_Chill") %&gt;%</span>
<span class='co'>#                 pull(max_val),</span>
<span class='co'>#               value = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Wind_Chill") %&gt;%</span>
<span class='co'>#                 pull(med_val),</span>
<span class='co'>#               step = 1,</span>
<span class='co'>#               round = TRUE),</span>
<span class='co'>#       sliderInput(inputId = "Humidity",</span>
<span class='co'>#               label = "Humidity when accident happened",</span>
<span class='co'>#               min = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Humidity") %&gt;%</span>
<span class='co'>#                 pull(min_val),</span>
<span class='co'>#               max = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Humidity") %&gt;%</span>
<span class='co'>#                 pull(max_val),</span>
<span class='co'>#               value = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Humidity") %&gt;%</span>
<span class='co'>#                 pull(med_val),</span>
<span class='co'>#               step = 1,</span>
<span class='co'>#               round = TRUE),</span>
<span class='co'>#       sliderInput(inputId = "Pressure",</span>
<span class='co'>#               label = "Pressure when accident happened",</span>
<span class='co'>#               min = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Pressure") %&gt;%</span>
<span class='co'>#                 pull(min_val),</span>
<span class='co'>#               max = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Pressure") %&gt;%</span>
<span class='co'>#                 pull(max_val),</span>
<span class='co'>#               value = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Pressure") %&gt;%</span>
<span class='co'>#                 pull(med_val),</span>
<span class='co'>#               step = 1,</span>
<span class='co'>#               round = TRUE),</span>
<span class='co'>#       sliderInput(inputId = "Visibility",</span>
<span class='co'>#               label = "Visibility when accident happened",</span>
<span class='co'>#               min = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Visibility") %&gt;%</span>
<span class='co'>#                 pull(min_val),</span>
<span class='co'>#               max = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Visibility") %&gt;%</span>
<span class='co'>#                 pull(max_val),</span>
<span class='co'>#               value = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Visibility") %&gt;%</span>
<span class='co'>#                 pull(med_val),</span>
<span class='co'>#               step = 1,</span>
<span class='co'>#               round = TRUE),</span>
<span class='co'>#       sliderInput(inputId = "Wind_Speed",</span>
<span class='co'>#               label = "Wind speed when accident happened",</span>
<span class='co'>#               min = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Wind_Speed") %&gt;%</span>
<span class='co'>#                 pull(min_val),</span>
<span class='co'>#               max = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Wind_Speed") %&gt;%</span>
<span class='co'>#                 pull(max_val),</span>
<span class='co'>#               value = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Wind_Speed") %&gt;%</span>
<span class='co'>#                 pull(med_val),</span>
<span class='co'>#               step = 1,</span>
<span class='co'>#               round = TRUE),</span>
<span class='co'>#       sliderInput(inputId = "Precipitation",</span>
<span class='co'>#               label = "Precipitation when accident happened in inches",</span>
<span class='co'>#               min = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Precipitation") %&gt;%</span>
<span class='co'>#                 pull(min_val),</span>
<span class='co'>#               max = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Precipitation") %&gt;%</span>
<span class='co'>#                 pull(max_val),</span>
<span class='co'>#               value = stats_num %&gt;%</span>
<span class='co'>#                 filter(variable =="Precipitation") %&gt;%</span>
<span class='co'>#                 pull(med_val),</span>
<span class='co'>#               step = 1,</span>
<span class='co'>#               round = TRUE),</span>
<span class='co'>#       selectInput(inputId = "Crossing",</span>
<span class='co'>#               label = "Is there a crossing where the accident happened?",</span>
<span class='co'>#               choices = list(Yes = "TRUE",</span>
<span class='co'>#                              No = "FALSE")),</span>
<span class='co'>#       selectInput(inputId = "Junction",</span>
<span class='co'>#               label = "Is there a junction where the accident happened?",</span>
<span class='co'>#               choices = list(Yes = "TRUE",</span>
<span class='co'>#                              No = "FALSE")),</span>
<span class='co'>#       selectInput(inputId = "Traffic_Signal",</span>
<span class='co'>#               label = "Is there a traffic signal where the accident happened?",</span>
<span class='co'>#               choices = list(Yes = "TRUE",</span>
<span class='co'>#                              No = "FALSE")),</span>
<span class='co'>#       selectInput(inputId = "Sunrise_Sunset",</span>
<span class='co'>#               label = "Is it night or day?",</span>
<span class='co'>#               choices = list(Night = "Night",</span>
<span class='co'>#                              Day = "Day")),</span>
<span class='co'>#       selectInput(inputId = "Civil_Twilight",</span>
<span class='co'>#               label = "Is there enough natural light to be day?",</span>
<span class='co'>#               choices = list(Yes = "Day",</span>
<span class='co'>#                              No = "Night")),</span>
<span class='co'>#       selectInput(inputId = "Nautical_Twilight",</span>
<span class='co'>#               label = "Is it nautical day or night?",</span>
<span class='co'>#               choices = list("Day","Night")),</span>
<span class='co'>#       selectInput(inputId = "Astronomical_Twilight",</span>
<span class='co'>#               label = "Was the sky illuminated by the sun?",</span>
<span class='co'>#               choices = list(Yes = "Day",</span>
<span class='co'>#                              No = "Night")),</span>
<span class='co'>#       selectInput(inputId = "Weather_Condition",</span>
<span class='co'>#               label = "Weather condition when accident happened",</span>
<span class='co'>#               choices = Weather),</span>
<span class='co'>#       submitButton(text = "Get the Prediction"),</span>
<span class='co'>#     ),</span>
<span class='co'>#       mainPanel(</span>
<span class='co'>#         verbatimTextOutput("Pred")</span>
<span class='co'>#       )</span>
<span class='co'>#    )</span>
<span class='co'># ),</span>
<span class='co'># server = function (input,output) {</span>
<span class='co'>#   output$Pred &lt;- renderPrint({</span>
<span class='co'>#     data &lt;- tibble(</span>
<span class='co'>#       # TMC=input$TMC,</span>
<span class='co'>#       Month=input$Month,</span>
<span class='co'>#       Hour=input$Hour,</span>
<span class='co'>#       Wday=input$Wday,</span>
<span class='co'>#       Duration=input$Duration,</span>
<span class='co'>#       Start_Lat=input$Start_Lat,</span>
<span class='co'>#       Start_Lng=input$Start_Lng,</span>
<span class='co'>#       Distance=input$Distance,</span>
<span class='co'>#       Side=input$Side,</span>
<span class='co'>#       City=input$City,</span>
<span class='co'>#       Temperature=input$Temperature,</span>
<span class='co'>#       Wind_Chill=input$Wind_Chill,</span>
<span class='co'>#       Humidity=input$Humidity,</span>
<span class='co'>#       Pressure=input$Pressure,</span>
<span class='co'>#       Visibility=input$Visibility,</span>
<span class='co'>#       Wind_Speed=input$Wind_Speed,</span>
<span class='co'>#       Precipitation=input$Precipitation,</span>
<span class='co'>#       Crossing=input$Crossing,</span>
<span class='co'>#       Junction=input$Junction,</span>
<span class='co'>#       Traffic_Signal=input$Traffic_Signal,</span>
<span class='co'>#       Sunrise_Sunset=input$Sunrise_Sunset,</span>
<span class='co'>#       Civil_Twilight=input$Civil_Twilight,</span>
<span class='co'>#       Nautical_Twilight=input$Nautical_Twilight,</span>
<span class='co'>#       Astronomical_Twilight=input$Astronomical_Twilight,</span>
<span class='co'>#       Weather_Condition=input$Weather_Condition</span>
<span class='co'>#     )</span>
<span class='co'>#     pred &lt;-</span>
<span class='co'>#       predict(traffic_mod,data) %&gt;%</span>
<span class='co'>#       pull(.pred_class)</span>
<span class='co'># </span>
<span class='co'>#     pred}</span>
<span class='co'>#   )</span>
<span class='co'># },</span>
<span class='co'># </span>
<span class='co'>#   options = list(height = 500)</span>
<span class='co'># )</span>
</code></pre>
</div>
</div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
